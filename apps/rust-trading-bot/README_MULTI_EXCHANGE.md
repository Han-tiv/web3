# 🚀 多交易所并发跟单系统

一个基于 Rust 的高性能多交易所并发跟单系统，支持 OKX、Bitget、Bybit、Gate 等主流交易所。

## ⚡ 快速开始

### 1. 配置环境变量

编辑 `/home/hanins/code/web3/.env`，确保包含以下配置：

```bash
# Telegram 配置
TELEGRAM_API_ID=your_api_id
TELEGRAM_API_HASH=your_api_hash
TELEGRAM_PHONE=+1234567890
TARGET_CHANNEL_ID=-1001234567890

# 交易配置
SIGNAL_LEVERAGE=10                # 杠杆倍数
SIGNAL_MARGIN=50                  # 每次保证金 (USDT)
SIGNAL_MARGIN_TYPE=CROSSED        # CROSSED=全仓, ISOLATED=逐仓
SIGNAL_POSITION_MODE=SINGLE       # SINGLE=单向, DUAL=双向
SIGNAL_TRADING_ENABLED=false      # true=交易, false=仅监听

# 至少配置一个交易所
OKX_API_KEY=...
OKX_SECRET=...
OKX_PASSPHRASE=...
```

### 2. 使用启动脚本

```bash
./run.sh
```

选择操作：
1. 编译所有程序
2. 启动主程序
3. 查看资产
4. 获取频道列表
5. 清理编译文件
6. 查看使用指南

### 3. 或者直接运行

```bash
# 查看资产
cargo run --release --bin show_assets

# 启动跟单
cargo run --release --bin multi_signal_trader
```

## 📊 支持的交易所

| 交易所 | 状态 | 说明 |
|--------|------|------|
| OKX | ✅ | 完整支持 |
| Bitget | ✅ | 完整支持 |
| Bybit | ✅ | 完整支持 |
| Gate.io | ✅ | 完整支持 |
| Binance | ✅ | 完整支持 |
| Hyperliquid | ✅ | 完整支持（DEX） |

## 🎯 核心特性

- ✅ **并发执行**: 所有交易所同时下单，秒级响应
- ✅ **统一配置**: 一套参数控制所有交易所
- ✅ **自动重连**: 网络断开自动恢复
- ✅ **交易锁**: 防止并发冲突
- ✅ **实时监控**: Telegram 频道信号实时跟单
- ✅ **资产展示**: 跨交易所余额、持仓、盈亏统计

## 📚 文档

- [完整使用指南](./MULTI_EXCHANGE_GUIDE.md) - 详细的配置和使用说明
- [实现总结](./IMPLEMENTATION_SUMMARY.md) - 技术实现细节

## 🎨 界面预览

### 启动界面

```
🤖 多交易所并发信号交易系统

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📊 配置摘要
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🔑 Telegram API ID: 2040
📱 手机号: +17578852234
🎯 监听频道 ID: 2291145819
⚡ 杠杆: 15x
💵 保证金: 2 USDT
🏦 仓位模式: 逐仓模式
📐 持仓模式: 单向持仓
🏢 已加载交易所数量: 4
   ✓ OKX
   ✓ Bitget
   ✓ Bybit
   ✓ Gate
🔄 交易状态: ✅ 启用
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

### 执行示例

```
📨 [15:30:45] 目标频道新消息
   频道ID: 2291145819 (CM AI SIGNAL)
   完整内容: BTCUSDT - 看涨📈

🎯 检测到信号: OpenLong("BTCUSDT")

🚀 开始并发执行到所有交易所...

[OKX] 📈 执行开多: BTCUSDT
[OKX] 💰 计算: 保证金50U × 10倍 = 500U, 价格:42500, 数量:0.0117
[OKX] ✅ 开多成功: BTCUSDT

[Bitget] 📈 执行开多: BTCUSDT
[Bitget] 💰 计算: 保证金50U × 10倍 = 500U, 价格:42501, 数量:0.0117
[Bitget] ✅ 开多成功: BTCUSDT

📊 执行结果汇总:
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ [OKX] 开多成功: BTCUSDT
✅ [Bitget] 开多成功: BTCUSDT
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 成功: 2 | ❌ 失败: 0
```

### 资产查看

```
╔═══════════════════════════════════════════════════════════════╗
║          💎 多交易所资产监控面板 💎                          ║
╚═══════════════════════════════════════════════════════════════╝

┌─────────────────────────────────────────────────────────────┐
│ 🏦 OKX                                                        │
├─────────────────────────────────────────────────────────────┤
│ 💰 账户余额
│   总余额:             1250.50 USDT
│   可用余额:           1100.25 USDT
│   未实现盈亏:           45.30 USDT
│   已用保证金:          150.25 USDT
│
│ 📊 持仓 (2 个)
│   📈 BTCUSDT LONG
│     数量:            0.0150
│     入场价:       42500.00 USDT
│     标记价:       42800.00 USDT
│     盈亏:            22.50 USDT
│     杠杆:               10x
│     保证金:          63.75 USDT
│     回报率:          35.29%
└─────────────────────────────────────────────────────────────┘
```

## ⚠️ 风险提示

1. 加密货币交易存在高风险
2. 杠杆交易可能导致爆仓
3. 建议先在测试网或小资金测试
4. 设置合理的风控参数
5. 本系统仅供学习研究使用

## 📞 技术支持

- 查看 [使用指南](./MULTI_EXCHANGE_GUIDE.md)
- 查看 [实现总结](./IMPLEMENTATION_SUMMARY.md)
- 查看源代码注释

## 📝 许可证

MIT License

---

**祝交易顺利！ 🚀📈**
