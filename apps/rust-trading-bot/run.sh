#!/bin/bash

# å¤šäº¤æ˜“æ‰€å¹¶å‘è·Ÿå•ç³»ç»Ÿå¿«é€Ÿå¯åŠ¨è„šæœ¬

set -e

cd "$(dirname "$0")"

echo "ğŸš€ å¤šäº¤æ˜“æ‰€å¹¶å‘è·Ÿå•ç³»ç»Ÿ"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""

# æ£€æŸ¥ .env æ–‡ä»¶
if [ ! -f "../../.env" ]; then
    echo "âŒ é”™è¯¯: æœªæ‰¾åˆ° .env æ–‡ä»¶"
    echo "è¯·åœ¨ /home/hanins/code/web3/.env ä¸­é…ç½®ç¯å¢ƒå˜é‡"
    exit 1
fi

# æ˜¾ç¤ºèœå•
echo "è¯·é€‰æ‹©æ“ä½œ:"
echo "  1) ğŸ—ï¸  ç¼–è¯‘æ‰€æœ‰ç¨‹åº"
echo "  2) ğŸš€ å¯åŠ¨ä¸»ç¨‹åº (multi_signal_trader)"
echo "  3) ğŸ’ æŸ¥çœ‹èµ„äº§ (show_assets)"
echo "  4) ğŸ” è·å– Telegram é¢‘é“åˆ—è¡¨ (get_channels)"
echo "  5) ğŸ§¹ æ¸…ç†ç¼–è¯‘æ–‡ä»¶"
echo "  6) ğŸ“š æŸ¥çœ‹ä½¿ç”¨æŒ‡å—"
echo ""
read -p "è¾“å…¥é€‰é¡¹ (1-6): " choice

case $choice in
    1)
        echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
        echo "ğŸ—ï¸  å¼€å§‹ç¼–è¯‘..."
        echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
        cargo build --release --bin multi_signal_trader --bin show_assets --bin get_channels
        echo ""
        echo "âœ… ç¼–è¯‘å®Œæˆï¼"
        echo "å¯æ‰§è¡Œæ–‡ä»¶ä½ç½®:"
        echo "  - ./target/release/multi_signal_trader"
        echo "  - ./target/release/show_assets"
        echo "  - ./target/release/get_channels"
        ;;
    2)
        echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
        echo "ğŸš€ å¯åŠ¨ä¸»ç¨‹åº..."
        echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
        echo "âš ï¸  ç¡®ä¿å·²é…ç½® .env æ–‡ä»¶ï¼"
        echo "âš ï¸  SIGNAL_TRADING_ENABLED=true æ‰ä¼šå®é™…äº¤æ˜“"
        echo ""
        read -p "æŒ‰ Enter ç»§ç»­..."
        RUST_LOG=info cargo run --release --bin multi_signal_trader
        ;;
    3)
        echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
        echo "ğŸ’ è·å–èµ„äº§ä¿¡æ¯..."
        echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
        RUST_LOG=error cargo run --release --bin show_assets
        ;;
    4)
        echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
        echo "ğŸ” è·å– Telegram é¢‘é“åˆ—è¡¨..."
        echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
        cargo run --release --bin get_channels
        ;;
    5)
        echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
        echo "ğŸ§¹ æ¸…ç†ç¼–è¯‘æ–‡ä»¶..."
        echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
        cargo clean
        echo "âœ… æ¸…ç†å®Œæˆï¼"
        ;;
    6)
        echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
        echo "ğŸ“š ä½¿ç”¨æŒ‡å—"
        echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
        if [ -f "MULTI_EXCHANGE_GUIDE.md" ]; then
            less MULTI_EXCHANGE_GUIDE.md
        else
            echo "âŒ æœªæ‰¾åˆ° MULTI_EXCHANGE_GUIDE.md"
        fi
        ;;
    *)
        echo "âŒ æ— æ•ˆé€‰é¡¹"
        exit 1
        ;;
esac
