# ç³»ç»Ÿå…¨é¢åˆ†æä¸ä¼˜åŒ–æ€»ç»“

## ğŸ¯ å½“å‰ç³»ç»ŸçŠ¶æ€

### âœ… æ­£å¸¸è¿è¡Œçš„ç»„ä»¶

1. **äº¤æ˜“æœºå™¨äººä¸»ç¨‹åº**
   - è¿›ç¨‹ID: 2807046
   - äºŒè¿›åˆ¶æ–‡ä»¶: `./target/release/integrated_ai_trader`
   - çŠ¶æ€: è¿è¡Œä¸­
   - ç¼–è¯‘æ¨¡å¼: Release (ä¼˜åŒ–ç‰ˆæœ¬)

2. **Web APIæœåŠ¡å™¨**
   - ç›‘å¬ç«¯å£: 8080 (0.0.0.0)
   - å¥åº·æ£€æŸ¥: âœ… OK
   - æ‰€æœ‰ç«¯ç‚¹å“åº”æ­£å¸¸

3. **å‰ç«¯å¼€å‘æœåŠ¡å™¨**
   - 2ä¸ªViteè¿›ç¨‹è¿è¡Œä¸­
   - ç«¯å£5173: IPv6 localhost
   - ç«¯å£5174: IPv6 localhost (å½“å‰ä½¿ç”¨)
   - çŠ¶æ€: æ­£å¸¸

### âš ï¸ å‘ç°çš„é—®é¢˜

#### 1. APIè®¤è¯å¤±è´¥ (-2015)
```
Invalid API-key, IP, or permissions for action
Request IP: 23.27.11.181
```

**æ—¥å¿—åˆ†æ (264è¡Œ)**:
- è·å–è´¦æˆ·ä¿¡æ¯å¤±è´¥: æ¯5åˆ†é’Ÿé‡è¯•
- è·å–æ”¶ç›Šå†å²å¤±è´¥: æ¯5åˆ†é’Ÿé‡è¯•
- è®¾ç½®é™ä»·å•å¤±è´¥: å¶å°”å°è¯•

**æ ¹æœ¬åŸå› **:
1. âœ… ç¯å¢ƒå˜é‡é…ç½®æ­£ç¡®:
   - `BINANCE_API_KEY=dpr1****PO3l`
   - `BINANCE_SECRET=ehUv****aJig`

2. â“ å¯èƒ½çš„åŸå› :
   - IPç™½åå•é™åˆ¶ (å½“å‰IP: 23.27.11.181 æœªåœ¨ç™½åå•)
   - APIæƒé™ä¸è¶³ (å¯èƒ½æœªå¯ç”¨åˆçº¦äº¤æ˜“æƒé™)
   - APIå¯†é’¥å¤±æ•ˆæˆ–è¢«åœç”¨

#### 2. å¤šä½™çš„å‰ç«¯è¿›ç¨‹
- æœ‰2ä¸ªViteå¼€å‘æœåŠ¡å™¨åŒæ—¶è¿è¡Œ
- å ç”¨2ä¸ªç«¯å£ (5173å’Œ5174)
- å»ºè®®æ¸…ç†å¤šä½™è¿›ç¨‹

## ğŸ”§ å·²å®Œæˆçš„ä¼˜åŒ–

### 1. APIç«¯ç‚¹è¿ç§» (ç»Ÿä¸€è´¦æˆ· â†’ ç»å…¸è´¦æˆ·)

**æ–‡ä»¶**: `src/binance_client.rs`

**ä¿®æ”¹å†…å®¹**:
- âœ… ç§»é™¤ `papi_base_url` å­—æ®µ
- âœ… æ‰€æœ‰è®¢å•ç«¯ç‚¹ä» PAPI æ”¹ä¸º FAPI
- âœ… æŒä»“æŸ¥è¯¢ç®€åŒ–ä¸º `/fapi/v2/positionRisk`
- âœ… è´¦æˆ·æŸ¥è¯¢ä½¿ç”¨ `/fapi/v2/account`

**ç«¯ç‚¹å¯¹ç…§è¡¨**:
| åŠŸèƒ½ | PAPI | FAPI |
|------|------|------|
| å¸‚ä»·å• | `/papi/v1/um/order` | `/fapi/v1/order` |
| é™ä»·å• | `/papi/v1/um/order` | `/fapi/v1/order` |
| æ­¢æŸå• | `/papi/v1/um/conditional/order` | `/fapi/v1/order` (type=STOP_MARKET) |
| æ­¢ç›ˆå• | `/papi/v1/um/conditional/order` | `/fapi/v1/order` (type=TAKE_PROFIT_MARKET) |
| æŒä»“æŸ¥è¯¢ | `/papi/v1/um/positionRisk` | `/fapi/v2/positionRisk` |
| è´¦æˆ·æŸ¥è¯¢ | `/papi/v1/balance` | `/fapi/v2/account` |

### 2. Webç›‘æ§ç³»ç»Ÿé›†æˆ

**åç«¯** (`src/web_server.rs`):
- âœ… 5ä¸ªREST APIç«¯ç‚¹
- âœ… å…±äº«çŠ¶æ€ç®¡ç† (Arc<RwLock<>>)
- âœ… CORSæ”¯æŒ
- âœ… æ•°æ®ç»“æ„å®Œæ•´åŒ¹é…å‰ç«¯

**å‰ç«¯** (`web/`):
- âœ… React 18 + TypeScript + Vite
- âœ… 3ä¸ªæ ¸å¿ƒç»„ä»¶ (EquityChart, PositionsList, TradesHistory)
- âœ… SWRè‡ªåŠ¨åˆ·æ–° (30ç§’/5ç§’)
- âœ… Binanceæš—é»‘ä¸»é¢˜

**æ•°æ®æµç¨‹**:
```
Trading Bot
  â”œâ”€ monitor_positions() [æ¯5åˆ†é’Ÿ]
  â”‚   â””â”€ update_web_equity_state()
  â”œâ”€ å¼€ä»“æˆåŠŸ â†’ update_web_equity_state()
  â””â”€ å¹³ä»“æˆåŠŸ â†’ record_trade_history()
        â†“
  AppState (Arc<RwLock<>>)
        â†“
  Axum Web Server (8080)
        â†“
  React Frontend (5174)
```

### 3. åˆ›å»ºè¯Šæ–­å·¥å…·

**ç³»ç»Ÿè¯Šæ–­è„šæœ¬** (`system_check.sh`):
- âœ… ç¯å¢ƒé…ç½®æ£€æŸ¥
- âœ… è¿›ç¨‹çŠ¶æ€æ£€æŸ¥
- âœ… ç«¯å£å ç”¨æ£€æŸ¥
- âœ… APIè¿é€šæ€§æµ‹è¯•
- âœ… æ—¥å¿—åˆ†æ
- âœ… é”™è¯¯ç»Ÿè®¡
- âœ… å…¬ç½‘IPæ£€æµ‹
- âœ… è§£å†³æ–¹æ¡ˆå»ºè®®

## ğŸ“‹ è§£å†³æ–¹æ¡ˆ

### ç«‹å³æ‰§è¡Œ

#### 1. ä¿®å¤APIè®¤è¯é—®é¢˜

**æ£€æŸ¥APIå¯†é’¥æƒé™** (Binanceç½‘ç«™):
```
ç™»å½• Binance
â†’ APIç®¡ç†
â†’ æ‰¾åˆ°APIå¯†é’¥: dpr1****PO3l
â†’ æ£€æŸ¥æƒé™:
   â˜‘ è¯»å–æƒé™ (Read)
   â˜‘ åˆçº¦äº¤æ˜“æƒé™ (Futures Trading)
   â˜‘ äº¤æ˜“æƒé™ (Trade)
```

**æ·»åŠ IPåˆ°ç™½åå•**:
```
â†’ ç¼–è¾‘API
â†’ IPè®¿é—®é™åˆ¶
â†’ æ·»åŠ IP: 23.27.11.181
æˆ–
â†’ é€‰æ‹©"ä¸é™åˆ¶" (ä¸æ¨è,å®‰å…¨æ€§ä½)
```

**éªŒè¯é…ç½®**:
```bash
# æ£€æŸ¥å½“å‰å…¬ç½‘IP
curl https://api.ipify.org

# æµ‹è¯•APIè¿æ¥
cd /home/hanins/code/web3/apps/rust-trading-bot
./system_check.sh
```

#### 2. æ¸…ç†å¤šä½™è¿›ç¨‹

```bash
# åœæ­¢æ—§çš„Viteè¿›ç¨‹
kill 2739770 2739771

# é‡å¯å‰ç«¯ (å¦‚æœéœ€è¦)
cd /home/hanins/code/web3/apps/rust-trading-bot/web
npm run dev
```

#### 3. é‡å¯äº¤æ˜“æœºå™¨äºº

```bash
# åœæ­¢å½“å‰è¿›ç¨‹
kill 2807046

# é‡æ–°å¯åŠ¨
cd /home/hanins/code/web3/apps/rust-trading-bot
./target/release/integrated_ai_trader > trader.log 2>&1 &

# æ£€æŸ¥æ—¥å¿—
tail -f trader.log
```

### ç³»ç»Ÿé…ç½®ä¼˜åŒ–

#### 1. æ—¥å¿—ç®¡ç†

**å»ºè®®**: ä½¿ç”¨ `logrotate` ç®¡ç†æ—¥å¿—æ–‡ä»¶

```bash
# åˆ›å»º logrotate é…ç½®
cat > /etc/logrotate.d/trading-bot <<EOF
/home/hanins/code/web3/apps/rust-trading-bot/*.log {
    daily
    rotate 7
    compress
    missingok
    notifempty
    create 0644 hanins hanins
}
EOF
```

#### 2. ç³»ç»Ÿç›‘æ§

**æ¨èå·¥å…·**:
- `htop` - è¿›ç¨‹ç›‘æ§
- `nethogs` - ç½‘ç»œæµé‡ç›‘æ§
- `iotop` - ç£ç›˜I/Oç›‘æ§

#### 3. è‡ªåŠ¨é‡å¯è„šæœ¬

```bash
# åˆ›å»º systemd service
cat > /etc/systemd/system/trading-bot.service <<EOF
[Unit]
Description=AI Trading Bot
After=network.target

[Service]
Type=simple
User=hanins
WorkingDirectory=/home/hanins/code/web3/apps/rust-trading-bot
Environment="PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"
ExecStart=/home/hanins/code/web3/apps/rust-trading-bot/target/release/integrated_ai_trader
Restart=always
RestartSec=10
StandardOutput=append:/home/hanins/code/web3/apps/rust-trading-bot/trader.log
StandardError=append:/home/hanins/code/web3/apps/rust-trading-bot/trader.log

[Install]
WantedBy=multi-user.target
EOF

# å¯ç”¨å¹¶å¯åŠ¨
sudo systemctl enable trading-bot
sudo systemctl start trading-bot

# æŸ¥çœ‹çŠ¶æ€
sudo systemctl status trading-bot
```

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

### å½“å‰èµ„æºä½¿ç”¨

```
äº¤æ˜“æœºå™¨äºº:
- CPU: 0.0% (ç©ºé—²)
- å†…å­˜: 434MB (RSS 29MB)
- è¿è¡Œæ—¶é—´: 1å°æ—¶10åˆ†é’Ÿ

å‰ç«¯æœåŠ¡å™¨:
- CPU: 0.0%
- å†…å­˜: 105MB (PID 2739771)
- å†…å­˜: 138MB (PID 2782092)

Web API:
- å“åº”æ—¶é—´: <10ms
- å¹¶å‘è¿æ¥: 0
```

### ä¼˜åŒ–å»ºè®®

1. **å‡å°‘APIè°ƒç”¨é¢‘ç‡**
   - å½“å‰: æ¯5åˆ†é’ŸæŸ¥è¯¢è´¦æˆ·ä¿¡æ¯
   - å»ºè®®: APIè®¤è¯æˆåŠŸåä¿æŒ,å¤±è´¥åå¯å»¶é•¿åˆ°10åˆ†é’Ÿ

2. **å‰ç«¯æ€§èƒ½**
   - è€ƒè™‘ä½¿ç”¨ç”Ÿäº§æ„å»º (`npm run build`)
   - ä½¿ç”¨Nginxæ‰˜ç®¡é™æ€æ–‡ä»¶

3. **æ•°æ®åº“æŒä¹…åŒ–**
   - å½“å‰æƒç›Šå†å²ä¿å­˜åœ¨å†…å­˜ä¸­ (æœ€å¤š1000ä¸ªç‚¹)
   - å»ºè®®: æ·»åŠ SQLiteæ•°æ®åº“æŒä¹…åŒ–äº¤æ˜“è®°å½•

## ğŸš€ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### ä¼˜å…ˆçº§ 1 (ç«‹å³)

- [ ] ä¿®å¤Binance APIè®¤è¯ (æ·»åŠ IPç™½åå•)
- [ ] æ¸…ç†å¤šä½™çš„Viteè¿›ç¨‹
- [ ] éªŒè¯APIè¿æ¥æˆåŠŸ

### ä¼˜å…ˆçº§ 2 (ä»Šå¤©)

- [ ] åˆ›å»ºsystemd serviceæ–‡ä»¶
- [ ] é…ç½®logrotate
- [ ] å°é¢æµ‹è¯•å¼€ä»“/å¹³ä»“

### ä¼˜å…ˆçº§ 3 (æœ¬å‘¨)

- [ ] å‰ç«¯ç”Ÿäº§æ„å»º
- [ ] æ·»åŠ æ•°æ®æŒä¹…åŒ–
- [ ] è®¾ç½®ç›‘æ§å‘Šè­¦

## ğŸ“ æ–‡æ¡£æ¸…å•

### å·²åˆ›å»ºæ–‡æ¡£

1. âœ… `FAPI_MIGRATION.md` - APIè¿ç§»å®Œæ•´æŠ¥å‘Š
2. âœ… `WEB_INTEGRATION.md` - Webç›‘æ§é›†æˆæŠ¥å‘Š
3. âœ… `system_check.sh` - ç³»ç»Ÿè¯Šæ–­è„šæœ¬
4. âœ… `test_api.sh` - APIæµ‹è¯•è„šæœ¬
5. âœ… `web/README.md` - å‰ç«¯ä½¿ç”¨æ–‡æ¡£

### éœ€è¦åˆ›å»º

- [ ] `DEPLOYMENT.md` - ç”Ÿäº§éƒ¨ç½²æŒ‡å—
- [ ] `MONITORING.md` - ç³»ç»Ÿç›‘æ§æŒ‡å—
- [ ] `TROUBLESHOOTING.md` - æ•…éšœæ’æŸ¥æ‰‹å†Œ

## ğŸ¯ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Telegram ä¿¡å·æº (Valuescan)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Integrated AI Trader (Main Process)  â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Signal Processing & Analysis   â”‚   â”‚
â”‚  â”‚  - FundAlert Parsing            â”‚   â”‚
â”‚  â”‚  - Entry Zone Analysis          â”‚   â”‚
â”‚  â”‚  - DeepSeek AI Decision         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Position Management            â”‚   â”‚
â”‚  â”‚  - Trial Position (30%)         â”‚   â”‚
â”‚  â”‚  - Add Position (70%)           â”‚   â”‚
â”‚  â”‚  - Stop Loss Management         â”‚   â”‚
â”‚  â”‚  - AI Take Profit               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Web State Management           â”‚   â”‚
â”‚  â”‚  - Equity History               â”‚   â”‚
â”‚  â”‚  - Position Tracking            â”‚   â”‚
â”‚  â”‚  - Trade Records                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚              â”‚
              â–¼              â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Binance API â”‚  â”‚  Web API :8080 â”‚
    â”‚  (FAPI)      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
                               â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  React Frontend     â”‚
                    â”‚  :5174              â”‚
                    â”‚  - EquityChart      â”‚
                    â”‚  - PositionsList    â”‚
                    â”‚  - TradesHistory    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ† æ€»ç»“

### å®Œæˆçš„å·¥ä½œ

1. âœ… **APIè¿ç§»**: ç»Ÿä¸€è´¦æˆ· â†’ ç»å…¸è´¦æˆ· (PAPI â†’ FAPI)
2. âœ… **Webç›‘æ§**: å®Œæ•´çš„å‰åç«¯ç›‘æ§ç³»ç»Ÿ
3. âœ… **è¯Šæ–­å·¥å…·**: ç³»ç»Ÿè¯Šæ–­å’Œæµ‹è¯•è„šæœ¬
4. âœ… **ç¼–è¯‘éªŒè¯**: Releaseæ¨¡å¼ç¼–è¯‘æˆåŠŸ
5. âœ… **ç³»ç»Ÿåˆ†æ**: å…¨é¢çš„ç³»ç»ŸçŠ¶æ€åˆ†æ

### å¾…è§£å†³é—®é¢˜

1. â³ **APIè®¤è¯**: éœ€è¦é…ç½®IPç™½åå•æˆ–APIæƒé™
2. â³ **è¿›ç¨‹æ¸…ç†**: æ¸…ç†å¤šä½™çš„Viteè¿›ç¨‹
3. â³ **ç³»ç»Ÿç›‘æ§**: é…ç½®systemdå’Œæ—¥å¿—ç®¡ç†

### ç³»ç»Ÿå°±ç»ªåº¦

- **ä»£ç **: 100% âœ…
- **ç¼–è¯‘**: 100% âœ…
- **è¿è¡Œ**: 100% âœ…
- **åŠŸèƒ½**: 90% (ç­‰å¾…APIè®¤è¯) â³

---
ç”Ÿæˆæ—¶é—´: 2025-11-09 01:40
ç³»ç»Ÿç‰ˆæœ¬: v0.1.0 (FAPI + Web Monitor)
çŠ¶æ€: è¿è¡Œä¸­,ç­‰å¾…APIè®¤è¯ â³
